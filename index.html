<!doctype html>
<html lang="en">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width,initial-scale=1,viewport-fit=cover" />
<meta name="theme-color" content="#1e1e2f"/>
<title>BRITS ABROAD 2025 â€“ Luxury Retirement Roadmap</title>
<style>
:root{
  --primary:#00247d; --accent:#c8102e; --bg:#f8f9fc; --card-bg:#ffffff;
  --success:#28a745; --glass: rgba(255,255,255,0.7);
  --font:"Inter", system-ui, -apple-system, "Segoe UI", Roboto, Arial, sans-serif;
}
*{box-sizing:border-box;}
html,body{height:100%; margin:0; font-family:var(--font);}
body{
  display:flex; flex-direction:column; align-items:center; background: linear-gradient(180deg,#f0f8ff 0%, #e6f2ff 100%);
  color:var(--primary); padding:12px;
}
h1,h2,h3{margin:0;}
h1{font-size:2.4rem; font-weight:800; letter-spacing:-0.02em;}
h2{font-size:1.6rem; margin-bottom:8px;}
p{margin:0.5em 0;}
.card{
  background:var(--card-bg); border-radius:16px; padding:20px; max-width:720px; margin:10px auto;
  box-shadow:0 10px 30px rgba(0,0,0,0.08); transition:all 0.25s ease;
}
.card:hover{transform:translateY(-4px); box-shadow:0 14px 34px rgba(0,0,0,0.12);}
button, select, input[type=range], input[type=number]{font-size:1rem;}
button{padding:12px 18px; border:none; border-radius:10px; background:var(--accent); color:#fff; cursor:pointer;}
button:hover{background:#a00d26;}
select{padding:10px 12px; border-radius:10px; border:2px solid var(--accent); background:#fff;}
input[type=range]{width:100%; accent-color:var(--accent); margin:8px 0;}
.row{display:flex; gap:12px; flex-wrap:wrap; align-items:center; justify-content:center;}
.muted{color:#555; opacity:0.8; font-size:.95rem;}
.progress-wrap{width:100%; padding:6px 0;}
.progress-bar{height:12px; background:#e0e5f2; border-radius:999px; overflow:hidden;}
.progress-fill{height:100%; width:0%; background:var(--accent); transition:width .4s ease;}
.phases{display:flex; gap:10px; flex-wrap:wrap; justify-content:center; margin-bottom:12px;}
.phase{width:84px; height:84px; border-radius:16px; background:#e6f2ff; display:flex; flex-direction:column; justify-content:center; align-items:center; cursor:pointer; transition:all .18s ease;}
.phase.active{background:var(--accent); color:#fff; transform:scale(1.05);}
.phase.completed{background:var(--success); color:#fff;}
.phase:hover{transform:translateY(-3px);}
.phase-icon{font-size:1.6rem;}
.countdown{font-weight:700; color:var(--accent); padding:10px 14px; border-radius:12px; background:#fff; box-shadow:0 6px 18px rgba(0,0,0,0.06); margin:8px auto; display:inline-block; font-size:1rem;}
.ai-summary{background:#fff; padding:16px; border-radius:14px; box-shadow:0 6px 18px rgba(0,0,0,0.06); margin-top:12px; font-size:1rem;}
@media(max-width:640px){.phase{width:70px;height:70px;font-size:.78rem;}}
</style>
</head>
<body>
<div class="card" style="text-align:center">
  <h1>BRITS ABROAD 2025</h1>
  <p>Luxury Retirement Roadmap â€“ Interactive Planner</p>
</div>

<div class="progress-wrap card">
  <div class="progress-bar"><div id="progressFill" class="progress-fill"></div></div>
</div>

<div class="phases" id="phases" aria-label="Phases Navigation"></div>

<section id="phaseContent" aria-live="polite">

  <!-- Phase 1: Dream Destination -->
  <div id="phase1" class="card">
    <h2>Phase 1: Dream Destination</h2>
    <div class="row">
      <label for="country" class="muted">Choose your country:</label>
      <select id="country"></select>
    </div>
    <button onclick="completePhase(1)">Complete Phase 1</button>
  </div>

  <!-- Phase 2: Financial Freedom -->
  <div id="phase2" class="card" style="display:none">
    <h2>Phase 2: Financial Freedom</h2>
    <div class="row">
      <div>
        <div class="muted">Annual Pension: Â£<span id="pensionVal">10000</span></div>
        <input id="pension" type="range" min="0" max="60000" value="10000" oninput="calc()"/>
      </div>
      <div>
        <div class="muted">UK Property: Â£<span id="propertyVal">300000</span></div>
        <input id="property" type="range" min="0" max="2000000" step="10000" value="300000" oninput="calc()"/>
      </div>
    </div>
    <div class="ai-summary" id="finResult">Your potential savings: Â£0/year</div>
    <button onclick="completePhase(2)">Complete Phase 2</button>
  </div>

  <!-- Phase 3: Visa Victory -->
  <div id="phase3" class="card" style="display:none">
    <h2>Phase 3: Visa Victory</h2>
    <div class="row">
      <select id="q1">
        <option value="">Monthly Income?</option>
        <option value="0">Under â‚¬870</option>
        <option value="1">â‚¬870â€“â‚¬3,279</option>
        <option value="2">â‚¬3,280+</option>
      </select>
      <select id="q2">
        <option value="">Remote Work?</option>
        <option value="0">No</option>
        <option value="1">Yes</option>
      </select>
      <select id="q4">
        <option value="">Family Joining?</option>
        <option value="0">No</option>
        <option value="1">Yes</option>
      </select>
    </div>
    <div class="ai-summary" id="visaResult">Visa suggestion will appear here</div>
    <button onclick="completePhase(3)">Complete Phase 3</button>
  </div>

  <!-- Phase 4: Document Checklist -->
  <div id="phase4" class="card" style="display:none">
    <h2>Phase 4: Document Checklist</h2>
    <p class="muted">Upload relevant documents for relocation:</p>
    <input type="file" id="files" multiple />
    <div class="ai-summary" id="docResult">No files chosen</div>
    <button onclick="completePhase(4)">Complete Phase 4</button>
  </div>

  <!-- Phase 5: Budget Blueprint -->
  <div id="phase5" class="card" style="display:none">
    <h2>Phase 5: Budget Blueprint</h2>
    <div class="row">
      <label for="budgetIncome">Monthly Income (Â£):</label>
      <input id="budgetIncome" type="number" min="0" value="2000">
    </div>
    <div class="row">
      <label for="budgetExpenses">Monthly Expenses (Â£):</label>
      <input id="budgetExpenses" type="number" min="0" value="1200">
    </div>
    <div class="ai-summary" id="budgetResult">Balance will be calculated here</div>
    <button onclick="completePhase(5)">Complete Phase 5</button>
  </div>

  <!-- Phase 6: Move Mastery -->
  <div id="phase6" class="card" style="display:none">
    <h2>Phase 6: Move Mastery</h2>
    <div class="row">
      <label><input type="checkbox" id="pack1"> Pack Essentials</label>
      <label><input type="checkbox" id="pack2"> Arrange Movers</label>
      <label><input type="checkbox" id="pack3"> Schedule Utilities</label>
    </div>
    <div class="ai-summary" id="moveResult">Tasks checked will appear here</div>
    <button onclick="completePhase(6)">Complete Phase 6</button>
  </div>

  <!-- Phase 7: Settlement Success -->
  <div id="phase7" class="card" style="display:none">
    <h2>Phase 7: Settlement Success</h2>
    <div class="row">
      <label for="propertyRent">Rent/Buy Property (Â£/month):</label>
      <input type="number" id="propertyRent" value="1500">
    </div>
    <div class="row">
      <label for="settleArea">Preferred Area:</label>
      <input type="text" id="settleArea" value="City Center">
    </div>
    <div class="ai-summary" id="settleResult">Settlement info updated</div>
    <button onclick="completePhase(7)">Complete Phase 7</button>
  </div>

  <!-- Phase 8: Community Connections -->
  <div id="phase8" class="card" style="display:none">
    <h2>Phase 8: Community Connections</h2>
    <div class="row">
      <label><input type="checkbox" id="conn1"> Join Expat Group</label>
      <label><input type="checkbox" id="conn2"> Attend Local Events</label>
      <label><input type="checkbox" id="conn3"> Learn Local Language</label>
    </div>
    <div class="ai-summary" id="connResult">Connections logged</div>
    <button onclick="completePhase(8)">Complete Phase 8</button>
  </div>

  <!-- Phase 9: Tax Triumph -->
  <div id="phase9" class="card" style="display:none">
    <h2>Phase 9: Tax Triumph</h2>
    <div class="row">
      <label for="taxStatus">Tax Residency:</label>
      <select id="taxStatus">
        <option value="UK">UK</option>
        <option value="Host">Host Country</option>
      </select>
    </div>
    <div class="ai-summary" id="taxResult">Tax scenario preview</div>
    <button onclick="completePhase(9)">Complete Phase 9</button>
  </div>

  <!-- Phase 10: Celebration Station -->
  <div id="phase10" class="card" style="display:none">
    <h2>Phase 10: Celebration Station</h2>
    <p>Plan a luxury welcome party or celebration for your move!</p>
    <div class="row">
      <input type="text" id="celebrationPlan" placeholder="Party details">
    </div>
    <div class="ai-summary" id="celebrationResult">Party plan saved</div>
    <button onclick="completePhase(10)">Complete Phase 10</button>
  </div>

  <!-- Phase 11: Retirement Summary -->
  <div id="phase11" class="card" style="display:none">
    <h2>Phase 11: Retirement Summary</h2>
    <button onclick="getAISummary()">Get AI Summary</button>
    <div class="ai-summary" id="aiSummaryOutput">Your AI retirement plan will appear here...</div>
  </div>

</section>

<div class="countdown" id="countdown">Calculating time until top-up...</div>

<script>
// ---------- Data ----------
const PHASES = [
  {id:1,title:'Dream Destination',icon:'ðŸŒ'},
  {id:2,title:'Financial Freedom',icon:'ðŸ’°'},
  {id:3,title:'Visa Victory',icon:'ðŸ“‹'},
  {id:4,title:'Document Checklist',icon:'ðŸ“'},
  {id:5,title:'Budget Blueprint',icon:'ðŸ“Š'},
  {id:6,title:'Move Mastery',icon:'ðŸšš'},
  {id:7,title:'Settlement Success',icon:'ðŸ '},
  {id:8,title:'Community Connections',icon:'ðŸ‘¥'},
  {id:9,title:'Tax Triumph',icon:'ðŸ’¼'},
  {id:10,title:'Celebration Station',icon:'ðŸŽ‰'},
  {id:11,title:'Retirement Summary',icon:'ðŸ‘´'}
];

const COUNTRIES = { Portugal:1, Spain:1.05, UAE:1.6, Thailand:0.6, Cyprus:1, Greece:1.1, Italy:1.2, France:1.25 };

// ---------- State ----------
let currentPhase = 1;
const completed = [];

// ---------- DOM ----------
const phasesEl = document.getElementById('phases');
const progressFill = document.getElementById('progressFill');
const countrySelect = document.getElementById('country');

// ---------- Functions ----------
function buildPhases(){
  phasesEl.innerHTML = '';
  PHASES.forEach(p=>{
    const d = document.createElement('div');
    d.className='phase';
    d.dataset.phase=p.id;
    d.innerHTML=`<div class="phase-icon">${p.icon}</div><div>${p.title}</div>`;
    d.onclick=()=>showPhase(p.id);
    if(completed.includes(p.id)) d.classList.add('completed');
    if(p.id===currentPhase) d.classList.add('active');
    phasesEl.appendChild(d);
  });
  updateProgress();
}

function updateProgress(){
  const width=(currentPhase/PHASES.length)*100;
  progressFill.style.width=width+'%';
  document.querySelectorAll('.phase').forEach(el=>{
    el.classList.toggle('active',parseInt(el.dataset.phase)===currentPhase);
  });
}

function showPhase(n){
  PHASES.forEach(p=>{
    const el=document.getElementById('phase'+p.id);
    if(!el) return;
    el.style.display=(p.id===n)?'block':'none';
  });
  currentPhase=n;
  updateProgress();
}

function completePhase(n){
  if(!completed.includes(n)) completed.push(n);
  const next=n+1;
  if(next<=PHASES.length) showPhase(next);
  buildPhases();
}

// ---------- Phase 2 calculation ----------
function calc(){
  const pension=parseInt(document.getElementById('pension').value||0);
  const property=parseInt(document.getElementById('property').value||0);
  document.getElementById('pensionVal').textContent=pension.toLocaleString();
  document.getElementById('propertyVal').textContent=property.toLocaleString();
  const mult=COUNTRIES[countrySelect.value]||1;
  const savings=Math.round((pension*0.35 + property*0.0025)*mult);
  document.getElementById('finResult').textContent=`Estimated savings: Â£${savings.toLocaleString()}/year`;
}

// ---------- Phase 3 visa ----------
function updateVisa(){
  const income=parseInt(document.getElementById('q1').value||'-1');
  const remote=parseInt(document.getElementById('q2').value||'0');
  const family=parseInt(document.getElementById('q4').value||'0');
  let visa='Choose income/remote/family options';
  if(income!==-1){
    if(income===2 && remote===1) visa='Digital Nomad â€“ likely to qualify';
    else if(income===2) visa='Investor/Golden options or high-income visa';
    else if(income===1) visa='Non-lucrative / similar options likely';
    else visa='Lower income routes available';
    if(family===1) visa+=' â€” Family included';
  }
  document.getElementById('visaResult').textContent=visa;
}

// ---------- Phase 4 files ----------
document.getElementById('files').addEventListener('change', e=>{
  const files=Array.from(e.target.files||[]);
  let html='';
  files.forEach(f=> html+=f.name+'<br>');
  document.getElementById('docResult').innerHTML=html || 'No files chosen';
});

// ---------- Phase 5 budget ----------
function updateBudget(){
  const income=parseInt(document.getElementById('budgetIncome').value||0);
  const expenses=parseInt(document.getElementById('budgetExpenses').value||0);
  const balance=income-expenses;
  document.getElementById('budgetResult').textContent=`Estimated balance: Â£${balance.toLocaleString()}/month`;
}
document.getElementById('budgetIncome').addEventListener('input',updateBudget);
document.getElementById('budgetExpenses').addEventListener('input',updateBudget);

// ---------- Phase 6 move -->
function updateMove(){
  const tasks=['pack1','pack2','pack3'].filter(id=>document.getElementById(id).checked);
  document.getElementById('moveResult').textContent='Tasks completed: '+(tasks.join(', ')||'None');
}
['pack1','pack2','pack3'].forEach(id=>{
  document.getElementById(id).addEventListener('change',updateMove);
});

// ---------- Phase 7 settlement -->
function updateSettlement(){
  const rent=document.getElementById('propertyRent').value;
  const area=document.getElementById('settleArea').value;
  document.getElementById('settleResult').textContent=`Rent: Â£${rent}/month, Area: ${area}`;
}
document.getElementById('propertyRent').addEventListener('input',updateSettlement);
document.getElementById('
